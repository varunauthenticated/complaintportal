<div class="page-container">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="#/home">Home</a></li>
    <li class="breadcrumb-item active">{{title}}</li>
  </ol>

  <!-- Write Your Code -->
  <!-- start div for container -->
  <div class="container col-lg-12 col-md-12 col-sm-12 col-xs-12" style="width:100%;">

    <!--start search div -->
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
      <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
        <div class="input-group" style="width:100%;">
          &nbsp;
        </div>
      </div>
      <div [formGroup]="searchFormGroup" class="input-group col-lg-6 col-md-6 col-sm-6 col-xs-12" style="float: right;">
        <input type="search" class="form-control search-input" formControlName="gridSearch" placeholder="Search">
        <span class="input-group-addon"><i class="fa fa-search"></i></span>
      </div>
    </div>
    <!-- end of search div -->

   <!--start div for action button-->
   <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding-top: 60px; padding-bottom: 0px;">
    <button type="button" *ngIf="viewEditParam === 'modify'" class="btn btn-style2 cursor-pointer" (click)="editComplaint()" [disabled]="selectedData.length !== 1">
      <i class="fa fa-check-square-o" style="font-size: 13px; color: #FFFFFF"></i> CAPA 
    </button>
    <!-- <button type="button" *ngIf="viewEditParam === 'view'" class="btn btn-style2 cursor-pointer" (click)="viewComplaint()" [disabled]="selectedData.length !== 1">
      <i class="fa fa-street-view" style="font-size: 13px; color: #FFFFFF"></i> View 
    </button> -->
  </div>
  <!--end of div for action button-->

    <!-- start table div -->
    <div class="col-lg-12 col-md-12 col-xs-12" style="margin-bottom: 15px; margin-top: 5px;">
      <table class="table-style">
        <thead>
          <tr class="th-style">
            <td class="header-style-first">

            </td>

            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.complaintReferenceNo)">
              {{complaintDIViewDetails.header?.complaintReferenceNo}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.complaintReferenceNo && sortSelection.orderType == 'ASC'" class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.complaintReferenceNo && sortSelection.orderType == 'DESC'" class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>
            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.complaintReferenceDt)">
              {{complaintDIViewDetails.header?.complaintReferenceDt}}

              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.complaintReferenceDt && sortSelection.orderType == 'ASC'"
                class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.complaintReferenceDt && sortSelection.orderType == 'DESC'"
                class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>

            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.customerName)">
              {{complaintDIViewDetails.header?.customerName}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.customerName && sortSelection.orderType == 'ASC'" class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.customerName && sortSelection.orderType == 'DESC'" class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>
            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.correctiveAction)">
              {{complaintDIViewDetails.header?.correctiveAction}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.correctiveAction && sortSelection.orderType == 'ASC'"
                class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.correctiveAction && sortSelection.orderType == 'DESC'"
                class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>
            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.correctiveActionFiles)">
                {{complaintDIViewDetails.header?.correctiveActionFiles}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.correctiveActionFiles && sortSelection.orderType == 'ASC'"
                class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.correctiveActionFiles && sortSelection.orderType == 'DESC'"
                class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
              </td>

            <td class="header-style hideextra" (click)="onClick(complaintDIViewDetails.header.preventiveAction)">
              {{complaintDIViewDetails.header?.preventiveAction}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.preventiveAction && sortSelection.orderType == 'ASC'"
                class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.preventiveAction && sortSelection.orderType == 'DESC'"
                class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>

            <td class="header-style-last hideextra" (click)="onClick(complaintDIViewDetails.header.preventiveActionFiles)">
              {{complaintDIViewDetails.header?.preventiveActionFiles}}
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.preventiveActionFiles && sortSelection.orderType == 'ASC'" class="fa fa-sort-asc">
            </i>
              <i *ngIf="sortSelection.sortData == complaintDIViewDetails.header?.preventiveActionFiles && sortSelection.orderType == 'DESC'" class="fa fa-sort-desc">
            </i>
              <i *ngIf="sortSelection.orderType == ''" class="fa fa-sort">
            </i>
            </td>

          </tr>
        </thead>
        <tbody>
          <tr class="tr-style" *ngFor="let complaintViewValue of complaintDIViewDetails.details
          | isplSearch: searchFormGroup.value.gridSearch : complaintDIViewDetails.header;
              let odd = odd; let even = even;" [ngClass]="{even: even, odd: odd }">
            <ng-container *ngIf="viewEditParam === 'modify' then thenBlockOfEditCheckbox; else elseBlockOfviewCheckbox"></ng-container>
            <ng-template #thenBlockOfEditCheckbox>
              <ng-container *ngIf="complaintViewValue.activityId>capaActivityId then thenBlockOfCheckbox; else elseBlockOfCheckbox"></ng-container>
              <ng-template #thenBlockOfCheckbox>
                <td class="td-style-first"></td>
              </ng-template>
              <ng-template #elseBlockOfCheckbox>
                <td class="td-style-first">
                <input type="checkbox" [checked]="otherCheck" (click)="complaintDetailsByCheckbox(complaintViewValue)" />
                </td>
              </ng-template>
            </ng-template>
             <!-- start ng-template to enable view checkbox for capa -->
             <ng-template #elseBlockOfviewCheckbox>
              <td class="td-style-first">
                <!-- <input type="checkbox" [checked]="otherCheck" (click)="complaintDetailsByCheckbox(complaintViewValue)" /> -->
              </td>
             </ng-template>
             <!-- end of ng-template to enable view checkbox for capa -->
             <td class="td-style" *ngIf="viewEditParam === 'modify'">
                {{complaintViewValue.complaintReferenceNo}}
              </td>
              <td class="td-style" *ngIf="viewEditParam === 'view'">
                <span class="custom-link" title="Click here" (click)="complaintDetailsByCheckbox(complaintViewValue,'view')">
                  {{complaintViewValue.complaintReferenceNo}}
                </span>
              </td>        
            <td class="td-style">{{complaintViewValue.complaintReferenceDt|date: 'dd-MMM-yyyy'}}</td>
            <td class="td-style">{{complaintViewValue.customerDetails.customerName}}</td>
            <td class="td-style">{{complaintViewValue.correctiveAction}}</td>
            <ng-container *ngIf="complaintViewValue.correctiveActionFiles.length==0 then thenBlockofCorrectiveFiles; else elseBlockCorrectiveFiles"></ng-container>
            <ng-template #thenBlockofCorrectiveFiles>
              <td class="td-style"></td>
            </ng-template>
            <ng-template #elseBlockCorrectiveFiles>
              <td class="td-style">
                <input id="{{complaintViewValue.complaintReferenceNo}}" class="toggle input-checkbox" type="checkbox">
                <label for="{{complaintViewValue.complaintReferenceNo}}">Files</label>
                <div id="{{complaintViewValue.complaintReferenceNo}}" class="expand">
                  <section>
                    <ng-container *ngFor="let file of complaintViewValue.correctiveActionFiles">
                      <a class="file-url" href="{{file.fileUrl}}" target="_blank">{{file.fileName}}</a>
                      <br/>
                    </ng-container>
                  </section>
                </div>
              </td>
            </ng-template>
            <td class="td-style">{{complaintViewValue.preventiveAction}}</td>
            <ng-container *ngIf="complaintViewValue.preventiveActionFiles.length==0 then thenBlockofPreventiveFiles; else elseBlockofPreventiveFiles"></ng-container>
            <ng-template #thenBlockofPreventiveFiles>
              <td class="td-style-last"></td>
            </ng-template>
            <ng-template #elseBlockofPreventiveFiles>
              <td class="td-style-last">
                <input id="{{complaintViewValue.preventiveAction}}" class="toggle input-checkbox" type="checkbox">
                <label for="{{complaintViewValue.preventiveAction}}">Files</label>
                <div id="{{complaintViewValue.preventiveAction}}" class="expand">
                  <section>
                    <ng-container *ngFor="let file of complaintViewValue.preventiveActionFiles">
                      <a class="file-url" href="{{file.fileUrl}}" target="_blank">{{file.fileName}}</a>
                      <br/>
                    </ng-container>
                  </section>
                </div>
              </td>
            </ng-template>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- end of table div -->

  </div>
  <!-- end of div container -->
</div>
<!-- end of div page-container -->

<ispl-busy-spinner *ngIf="!complaintDIViewDetails.header && !complaintDIViewDetails.details">

</ispl-busy-spinner>